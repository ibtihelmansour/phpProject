"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function _createClass(e,n,r){return n&&_defineProperties(e.prototype,n),r&&_defineProperties(e,r),e}!function(){if(window.Promise){var e=function(){function n(e){_classCallCheck(this,n),this._namespace=e||""}return _createClass(n,[{key:"ErrorHandler",value:function(){var o=this;return{newError:function(e,n,r){var t=2<arguments.length&&void 0!==r?r:null;o.LogService().add("error",{origin:e,message:n,data:t})},unhandledError:function(e,n){o.Log('Unhandled error from: "'.concat(e,'", timestamp: ').concat(Date.now()),"error",[n.message,n.stack])}}}},{key:"CambioMoneda",value:function(e){var n=e||{AT:1,BE:1,BG:.510204,CH:.87556,CN:.13421,CZ:.039427,DE:1,DK:.134026,EE:1,ES:1,FI:1,FR:1,GB:1.161288,GR:1,HR:.135135,HU:.003086,IC:1,IE:1,IT:1,JP:.007631,KR:748e-6,LT:1,LU:1,LV:1,MT:1,MX:.043717,NL:1,PL:.240317,PT:1,RO:.221146,RU:.013031,SE:.095985,SI:1,SK:1,TR:.153636,US:.846478},r=window.inditex.iUserJSON.shopCart.totalOrder,t=window.inditex.iStoreJSON.details.locale.currencyDecimals,o=n[window.inditex.iCountryCode]||1;return 0===t?Math.round(r*o*100):-2===t?Math.round(r*o):void 0}},{key:"Events",value:function(){function t(e,r){return function(n){return e.forEach(function(e){return"add"===n?o(e,r):i(e,r)})}}function l(e,n,r){a[n]=r,e===(document||window)?o(e,n):t(e,n)("add")}function u(e,n){a[n]||s.LogService().add("warning",{origin:"Events: off",message:'"'.concat(n,'" event listener removed. off called before on'),data:[{element:e,eventName:n}]}),e===(document||window)?i(e,n):t(e,n)("remove"),delete a[n]}var s=this,o=function(e,n){return e.addEventListener(n.split(".")[0],a[n])},i=function(e,n){return e.removeEventListener(n.split(".")[0],a[n])},a={},d={};return{trigger:function(e,n){var r=1<arguments.length&&void 0!==n?n:{},t=r.element,o=void 0===t?document:t,i=r.data,a=void 0===i?null:i,c=r.callback,l=void 0===c?void 0:c;d[e]=new window.CustomEvent(e,a),o.dispatchEvent(d[e]),l&&l()},listen:function(e,n){var r=n.element,t=void 0===r?document:r,o=n.type,i=void 0===o?"on":o,a=n.callback;a||s.ErrorHandler().newError("Events: listen","No callback was submitted",{arguments:{eventName:e,element:t,callback:a}});try{var c;if((c=t===document?document:t===window?window:document.querySelectorAll(t))!==document&&c!==window&&0===c.length)throw new Error("No elements matching selector");s.Switch({on:function(){l(c,e,a)},off:function(){u(c,e)},all:function(){u(c,e),l(c,e,a)},once:function(){!function(e,r,t){function n(n){n.addEventListener(r,function e(){return n.removeEventListener(r,e),t()})}e===document||e===window?n(e):e.forEach(function(e){return n(e)})}(c,e,a)}},i)}catch(e){s.ErrorHandler().newError("Events: listen",e.message,e.stack)}}}}},{key:"Log",value:function(e,n,r){var t={namespace:{style:"line-height:1em;font-size:1em;color:gray;border:1px solid gray;padding:6px 8px;border-radius:2px;"},levels:{info:"line-height:1em;font-size:1em;color:deepskyblue;border:1px solid deepskyblue;padding:6px 8px;border-radius:2px;",success:"line-height:1em;font-size:1em;color:yellowgreen;border:1px solid yellowgreen;padding:6px 8px;border-radius:2px;",warning:"line-height:1em;font-size:1em;color:orange;border:1px solid orange;padding:6px 8px;border-radius:2px;",error:"line-height:1em;font-size:1em;color:crimson;border:1px solid crimson;padding:6px 8px;border-radius:2px;",default:"line-height:1em;font-size:1em;font-style:italic;color:gray;",checkpoint:"border:1px solid DodgerBlue;color:DodgerBlue;line-height:1em;font-size:1em;padding:6px 8px;border-radius:2px;"}},o=n||"default";window.persoDebug&&"true"===window.inditex.readCookie("optly_personaliza_test")&&(r?("table"===n?(console.groupCollapsed("%c".concat(this._namespace,"%c - %c").concat(e),t.namespace.style,"",t.levels.default),r.forEach(function(e){console.table(e)})):(console.groupCollapsed("%c".concat(this._namespace,"%c - %c").concat(e),t.namespace.style,"",t.levels[o]),r.forEach(function(e){console.trace(e)})),console.groupEnd()):console.log("%c".concat(this._namespace,"%c - %c").concat(e),t.namespace.style,"",t.levels[o]))}},{key:"LogService",value:function(){function a(){return JSON.parse(window.sessionStorage.getItem("logService_".concat(s.namespace)))||[]}function c(e,n){return e.filter(function(e){return e.level===n})}function l(e,n){return e.filter(function(e){return e.body.origin===n})}var u=this,s={namespace:"",levels:[]};return{init:function(e){var n=0<arguments.length&&void 0!==e?e:{},r=n.namespace,t=void 0===r?null:r,o=n.levels,i=void 0===o?null:o,a="jetlorePdP",c=["info","warning","error"];s.namespace=t||a,s.levels=i||c},add:function(e,n){try{var r=Object.assign({timestamp:Date()},n),t=a();t.push({level:e,body:r}),window.sessionStorage.setItem("logService_".concat(s.namespace),JSON.stringify(t)),u.Log("".concat(n.message),e,n.data)}catch(e){u.ErrorHandler().unhandledError("logService",e)}},get:function(e){var n=0<arguments.length&&void 0!==e?e:{},r=n.level,t=void 0===r?null:r,o=n.origin,i=void 0===o?null:o;try{if(!t&&!i)return a();if(t)return c(a(),t);if(i)return l(a(),i);if(t&&i)return l(c(a(),t),i);throw new Error("Unknown error")}catch(e){return u.ErrorHandler().unhandledError("logService",e),u.Noop()}}}}},{key:"Noop",value:function(){}},{key:"Opti",value:function(){function o(){return window.optimizely.get("state").getCampaignStates(function(e){return!!e.isActive})}function i(e){return o()["number"==typeof e?e:parseInt(e)]}var t=this;return{track:function(e,n){var r={};t.Switch({event:function(){n.eventName&&(r.type=e,r.eventName=n.eventName||null)},page:function(){n.pageName&&(r.type=e,r.pageName=n.pageName||null,r.isActive=n.isActive||null)},addListener:function(){n.filter&&n.handler&&(r.type=e,r.filter={},r.filter.type=n.filter.type||null,r.filter.name=n.filter.name||null,r.handler=n.handler)},error:function(){return null}},e),!function(e){return 0===Object.keys(e).length}(r)?window.optimizely.push(r):t.Log("Not enought data to track the event","warning")},isCampaignActive:function(e){return!!i(e)},getCampaigns:o,getCampaign:i,findCampaigns:function(e,n){var r;for(var t in o()){i(t)[e]===("string"==typeof n?n:n.toString())&&(r=i(t));break}return r},getVariations:function(){var n=o();if(!n)return[];var r=[];return Object.keys(n).forEach(function(e){return r.push(n[parseInt(e)])}),r.map(function(e){return{campaignName:e.campaignName,variationName:e.variation.name,variationId:e.variation.id}})}}}},{key:"Shuffle",value:function(e){for(var n=e.length-1;0<n;n--){var r=Math.floor(Math.random()*(n+1)),t=[e[r],e[n]];e[n]=t[0],e[r]=t[1]}return e}},{key:"Switch",value:function(e,n){var r,t;return t=e,(r=function(e){return t.hasOwnProperty(e)?t[e]:t.error}(n))instanceof Function?r():r}},{key:"SkuTracker",value:function(){function r(e){window.localStorage.setItem(n,function(e){return JSON.stringify(e)}(e))}var n="opti_"+this._namespace+"_addedItems",t=function(){var e=window.localStorage.getItem(n);return e?function(e){return JSON.parse(e)}(e):null};return{get:t,add:function(e){var n=function(e){var n=t();return n?n.push(e):(n=[]).push(e),n}(e);r(n)},remove:function(){window.localStorage.removeItem(n)}}}}]),n}();window.Utils=e}else console.warn('Browser does not support ES6, not loading "utils"')}();